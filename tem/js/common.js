!function(){"use strict";var t=navigator.userAgent,e=/android/i.test(t)&&!/mobile/i.test(t);if(!e&&/(android)|(iphone)|(ipod)/i.test(t)&&!/mi pad/i.test(t))try{var n="/m/";location.replace(n)}catch(o){}}(),function(t){"use strict";window.util||(window.util={});var e=window.util,n=LOGIN_CONFIG.PTLOGIN_DAID,o="idesign";pt.setParams({appid:LOGIN_CONFIG.PTLOGIN_APPID,daid:n,style:20,protocol:"http:",domain:"qq.com",s_url:"http://"+o+".qq.com/like/login/check/type/qq/?ref="+decodeURIComponent(window.location.href),low_login:1,maskOpacity:40});var i="/login/isLogin";e.getCsrfToken=function(){var t="CSRF_TOKEN";return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},e.showLoginDialog=function(){ui.modal({className:"modal-login",width:600,height:360,showFooter:!1,title:"<span>请选择登录账户</span>",content:'<div class="main-login"><div class="main-login-left"><a class="login-qq" href="javascript:;"><i class="iconfont">&#xe601;</i></a></div><div class="sub-login"><div class="buttons"><a class="login-wechat" href="javascript:;"><i class="iconfont">&#xe603;</i></a></div></div><div class="main-login-right"><a class="login-weibo" href="javascript:;"><i class="iconfont">&#xe602;</i></a></div></div>',onShow:function(t){t.find(".modal-header").prepend('<div class="modal-logo"><img src="/static/images/logo.png" alt="腾讯设计导航"><span class="title">设计导航</span></div>'),t.addClass("actived")},onClose:function(t){t.remove()}})},e.login=null,e.checkLogin=function(){var n=t.Deferred();return t.getJSON(i,{_token:e.getCsrfToken()}).done(function(t){1===t.status?n.resolve(t.data):-1===t.status&&n.reject(t.info)}).fail(function(t){n.reject(t)}),n},e.parseHashString=function(){var t={};if(!location.hash||"#"===location.hash)return t;for(var e=location.hash.substr(2).split("/"),n=0,o=e.length;o>n;n+=2)e[n]&&(t[e[n]]=e[n+1]);for(var i in t)t.hasOwnProperty(i)&&("id"===i||"page"===i)&&(t[i]=parseInt(t[i],10));return t},e.setHashObject=function(t){var n=e.parseHashString(),o=[];for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(var a in n)n.hasOwnProperty(a)&&o.push(a+"/"+n[a]);e._noHashChange=!0,location.hash="!"+o.join("/"),setTimeout(function(){e._noHashChange=!1},0)}}(jQuery),$(function(){"use strict";var t=location.pathname,e=util.parseHashString();(t.indexOf("my")>-1||t.indexOf("/u/")>-1)&&$(".nav li").removeClass("current").filter(".user").addClass("current"),e.index&&$(".nav li").removeClass("current").filter("."+e.index).addClass("current"),"edit"===e.index&&$(".nav li").removeClass("current").filter(".feed").addClass("current"),ui.shareFactory.create($(".share-box"),{type:["weixin","qq","qzone","weibo"],text:"设计导航是一款由设计师自己驱动产品，①-参考了RSS阅读器的模式，将设计师经常浏览的工具型网站的内容聚合起来，提供更为便捷的浏览入口。 ②-除了收集了设计师常用网站外，还有用户精选高质量网站不间断更新，轻松把握行业动态。"}),$("#copyright-end").text((new Date).getFullYear()),$(window).on("hashchange",function(){util._noHashChange||location.reload()}),$(document).on("click",".unlogin",function(){util.showLoginDialog()}),$(document).on("click",".login-qq",function(){return pt.showPtui(),!1}),$(document).on("click",".login-wechat",function(){var t=util.getCsrfToken();ui.modal({className:"modal-iframe",width:600,height:500,showFooter:!1,title:"微信扫一扫登录",content:'<iframe src="https://open.weixin.qq.com/connect/qrconnect?appid='+LOGIN_CONFIG.WX_APP_KEY+"&redirect_uri="+LOGIN_CONFIG.WX_LOGIN_CB+"&response_type=code&scope=snsapi_login&state="+t+'#wechat_redirect" height="460"></iframe>',onClose:function(t){t.remove()}})}),$(document).on("click",".login-weibo",function(){return window.location.href="https://api.weibo.com/oauth2/authorize?client_id="+LOGIN_CONFIG.WEIBO_APP_KEY+"&response_type=code&redirect_uri="+LOGIN_CONFIG.WEIBO_LOGIN_CB,!1}),$(document).on("click",".user-logout",function(){pt_logout.logout(function(){window.location.href="/like/login/Callback_logout"})}),$(document).on("click","header .avatar",function(t){t.stopPropagation(),$(".usermenu").toggleClass("show-menu")}),$(document).on("click",function(){$(".usermenu").removeClass("show-menu"),$(document).find(".filter-list").removeClass("actived")}),$(document).on("click",".filter-list",function(t){t.stopPropagation();var e=$(this);e.siblings(".filter-list").removeClass("actived"),e.toggleClass("actived"),$(".usermenu").removeClass("show-menu")}),$(document).on("click",".filter-list a",function(){var t=$(this).parents(".filter-list"),e=$(this).text();t.find("span").text(e)})}),$(function(){"use strict";$(document).on("click",".feed-thumb-player",function(t){t.stopPropagation();var e=$(this),n=e.parents(".feed-thumb"),o=n.data("thumb"),i=n.data("original");i&&o&&(e.hasClass("playing")?(e.removeClass("playing"),n.css({"background-image":"url("+o+")"})):(e.addClass("playing"),n.css({"background-image":"url("+i+")"})))}),$(document).on("click","#feed-edit",function(t){return t.preventDefault(),util.login?void(location.href="/#!index/edit"):void util.showLoginDialog()}),$(document).on("click","#feed-add",function(t){return t.preventDefault(),util.login?void(location.href=$(this).attr("href")):void util.showLoginDialog()});var t="/my/FavObject",e="/my/UnFavObject";$(document).on("click",".feed-counts .icon-fav",function(n){if(n.stopPropagation(),!util.login)return void util.showLoginDialog();var o=$(this),i=o.parent().find(".num"),a=o.hasClass("faved"),s=parseInt(o.data("curr"),10),r=o.data("id"),c=o.data("type"),l={id:r,type:c,_token:util.getCsrfToken()};a?$.post(e,l).done(function(t){1===t.status&&(o.removeClass("faved"),i.html(s-1),o.data("curr",s-1),o.data("faved",""))}):$.post(t,l).done(function(t){1===t.status&&(o.addClass("faved"),i.html(s+1),o.data("curr",s+1),o.data("faved",!0))})})});